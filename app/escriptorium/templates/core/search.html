{% extends 'base.html' %}
{% load i18n staticfiles bootstrap %}

{% block head_title %}
{% trans "Search in projects" %}
{% endblock %}

{% block body %}
<div>
    <h2>{% trans "Search text in projects" %}</h2>
    <form method="get">
        <div class="form-row">
            <div class="col-auto">{% render_field form.project group=True %}</div>
            <div class="col mt-4">{% render_field form.query group=True %}</div>
            <div class="col-auto mt-4">
                <input type="submit" value="{% trans 'Search' %}" class="btn btn-primary"></input>
            </div>
        </div>
    </form>

    <hr>
    <div class="mt-4 mb-3">
        <h4>{% trans "Results" %} ({{ es_results | length }})</h4>
    </div>

    <table class="table table-hover">
        <thead>
            <tr>
                <th>{% trans "Content" %}</th>
                <th>{% trans "Document part" %}</th>
                <th>{% trans "Document" %}</th>
                <th>{% trans "Project" %}</th>
                <th>{% trans "Score" %}</th>
            </tr>
        </thead>
        <tbody>
            {% for content, part, document, project, score in es_results %}
            <tr>
                <td title="{% trans 'Transcription content' %}">{{ content }}</td>
                <td title="{% trans 'Document part' %}">
                    <a href="{% url 'document-part-edit' pk=document.pk part_pk=part.pk %}">
                        {{ part }}
                    </a>
                </td>
                <td title="{% trans 'Document' %}">
                    <a href="{% url 'document-images' pk=document.pk %}">
                        {{ document }}
                    </a>
                </td>
                <td title="{% trans 'Project' %}">
                    <a href="{% url 'documents-list' slug=project.slug %}">
                        {{ project }}
                    </a>
                </td>
                <td title="{% trans 'Search score' %}">{{ score }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">{% trans "No results matched your search." %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    {% include 'includes/pagination.html' %}
</div>
{% endblock %}